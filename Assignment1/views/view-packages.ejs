<html>
<head>
    <link href="/bootstrap.min.css" rel="stylesheet" />
    <style>
        .container-fluid {
            width: 85%;
            margin: 0 auto;
            display: flex; /* Use flexbox layout */
            flex-direction: column; /* Arrange items vertically */
            margin: 0 auto; /* Center horizontally */
            overflow: auto;
            height: 300px;
        }
    </style>
</head>
<body>
    <%- include('partials/header') %>
    <div class="container-fluid">
            <br>
            <div class="row row-cols-1 g-3">
                <div class="col">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                            <th scope="col">Id</th>
                            <th scope="col">Title</th>
                            <th scope="col">Weight</th>
                            <th scope="col">Destination</th>
                            <th scope="col">Description</th>
                            <th scope="col">Is Allocated</th>
                            <th scope="col">Driver ID</th>
                            <th scope="col">Created At</th>
                            <th scope="col">Delete</th>
                            </tr>
                        </thead>
                        
                        <tbody>
                            <% for (let i=0; i <records.length; i++){ %>
                            <tr>
                            <th scope="row"><%= records[i].id %></th>
                            <td><%= records[i].title %></td>
                            <td><%= records[i].weight %></td>
                            <td><%= records[i].destination %></td>
                            <td><%= records[i].description %></td>
                            <td><%= records[i].isAllocated %></td>
                            <td><%= records[i].driverId %></td>
                            <td><%= records[i].createdAt %></td>
                            <td><button onclick="deleteRow(this)" data-id="<%= records[i].id %>" class="btn btn-danger">X</button></td>
                            </tr>
                            <% } %>

                            <script>
                                function deleteRow(elem) {
                                    var packageId = elem.getAttribute('data-id');
                                    var row = elem.parentNode.parentNode; 
            
                                    // Send a DELETE request to the server
                                    fetch(`/33520496/Yang/packages/delete-packages-req?packageId=${packageId}`, {
                                        method: 'GET' 
                                    })

                                    .then(data => {
                                        row.parentNode.removeChild(row); // Remove the row
                                    })

                                }
                            </script>
                        </tbody>
                    </table>
                </div>
            </div>
    </div>
    <%- include('partials/footer') %> 
</body>
</html>
